{
  "hash": "f4b98349d93d08e9877aa37589816d4f",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Random Sampling\nformat:\n  html:\n    code-fold: false\n    toc: true\n---\n\n## Random Uniform Sampling\n\nFor many spatial models, it is common to take a random sample of the\npredictors to represent a single class (i.e. an environmental background or\npseudo-absences in a binary classification model). The sample function is\nsupplied in the sampling module for this purpose:\n\n::: {#a3807ffc .cell execution_count=1}\n``` {.python .cell-code}\nfrom pyspatialml import Raster\nimport pyspatialml.datasets.nc as nc\nimport matplotlib.pyplot as plt\n\npredictors = [nc.band1, nc.band2, nc.band3, nc.band4, nc.band5, nc.band7]\nstack = Raster(predictors)\n\n# extract training data using a random sample\ndf_rand = stack.sample(size=1000, random_state=1)\ndf_rand.plot()\n```\n\n::: {.cell-output .cell-output-display}\n![](sampling_files/figure-html/cell-2-output-1.png){width=480 height=411}\n:::\n:::\n\n\n## Stratified Random Sampling\n\nThe sample function also enables stratified random sampling based on passing a\ncategorical raster dataset to the strata argument. The categorical raster\nshould spatially overlap with the dataset to be sampled, but it does not need\nto be of the same grid resolution. This raster should be passed as a opened\nrasterio dataset:\n\n::: {#0245d53c .cell execution_count=2}\n``` {.python .cell-code}\nstrata = Raster(nc.strata)\ndf_strata = stack.sample(size=5, strata=strata, random_state=1)\ndf_strata = df_strata.dropna()\ndf_strata\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>lsat7_2000_10</th>\n      <th>lsat7_2000_20</th>\n      <th>lsat7_2000_30</th>\n      <th>lsat7_2000_40</th>\n      <th>lsat7_2000_50</th>\n      <th>lsat7_2000_70</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>96.0</td>\n      <td>78.0</td>\n      <td>88.0</td>\n      <td>49.0</td>\n      <td>71.0</td>\n      <td>63.0</td>\n      <td>POINT (641093.250 225135.750)</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>113.0</td>\n      <td>103.0</td>\n      <td>122.0</td>\n      <td>66.0</td>\n      <td>136.0</td>\n      <td>110.0</td>\n      <td>POINT (640979.250 222342.750)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>82.0</td>\n      <td>66.0</td>\n      <td>67.0</td>\n      <td>64.0</td>\n      <td>76.0</td>\n      <td>52.0</td>\n      <td>POINT (640095.750 225848.250)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>99.0</td>\n      <td>88.0</td>\n      <td>95.0</td>\n      <td>56.0</td>\n      <td>98.0</td>\n      <td>78.0</td>\n      <td>POINT (637559.250 226788.750)</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>81.0</td>\n      <td>69.0</td>\n      <td>76.0</td>\n      <td>73.0</td>\n      <td>118.0</td>\n      <td>72.0</td>\n      <td>POINT (635621.250 218324.250)</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>91.0</td>\n      <td>78.0</td>\n      <td>81.0</td>\n      <td>77.0</td>\n      <td>97.0</td>\n      <td>73.0</td>\n      <td>POINT (634709.250 221943.750)</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>72.0</td>\n      <td>61.0</td>\n      <td>51.0</td>\n      <td>104.0</td>\n      <td>91.0</td>\n      <td>47.0</td>\n      <td>POINT (639269.250 220005.750)</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>86.0</td>\n      <td>75.0</td>\n      <td>78.0</td>\n      <td>73.0</td>\n      <td>87.0</td>\n      <td>60.0</td>\n      <td>POINT (639326.250 224964.750)</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>71.0</td>\n      <td>53.0</td>\n      <td>48.0</td>\n      <td>59.0</td>\n      <td>78.0</td>\n      <td>46.0</td>\n      <td>POINT (635222.250 218951.250)</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>76.0</td>\n      <td>59.0</td>\n      <td>63.0</td>\n      <td>65.0</td>\n      <td>114.0</td>\n      <td>64.0</td>\n      <td>POINT (633027.750 218580.750)</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>75.0</td>\n      <td>61.0</td>\n      <td>55.0</td>\n      <td>70.0</td>\n      <td>74.0</td>\n      <td>43.0</td>\n      <td>POINT (633369.750 219435.750)</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>78.0</td>\n      <td>66.0</td>\n      <td>69.0</td>\n      <td>69.0</td>\n      <td>110.0</td>\n      <td>72.0</td>\n      <td>POINT (633198.750 225506.250)</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>68.0</td>\n      <td>52.0</td>\n      <td>40.0</td>\n      <td>79.0</td>\n      <td>58.0</td>\n      <td>30.0</td>\n      <td>POINT (637986.750 222998.250)</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>70.0</td>\n      <td>55.0</td>\n      <td>52.0</td>\n      <td>62.0</td>\n      <td>79.0</td>\n      <td>47.0</td>\n      <td>POINT (635649.750 217440.750)</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>71.0</td>\n      <td>53.0</td>\n      <td>48.0</td>\n      <td>64.0</td>\n      <td>77.0</td>\n      <td>42.0</td>\n      <td>POINT (635564.250 222713.250)</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>72.0</td>\n      <td>53.0</td>\n      <td>51.0</td>\n      <td>58.0</td>\n      <td>82.0</td>\n      <td>51.0</td>\n      <td>POINT (633056.250 218324.250)</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>81.0</td>\n      <td>78.0</td>\n      <td>79.0</td>\n      <td>34.0</td>\n      <td>41.0</td>\n      <td>28.0</td>\n      <td>POINT (639297.750 223625.250)</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>73.0</td>\n      <td>57.0</td>\n      <td>51.0</td>\n      <td>16.0</td>\n      <td>14.0</td>\n      <td>10.0</td>\n      <td>POINT (635364.750 224736.750)</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>73.0</td>\n      <td>57.0</td>\n      <td>52.0</td>\n      <td>55.0</td>\n      <td>57.0</td>\n      <td>40.0</td>\n      <td>POINT (635535.750 223311.750)</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>138.0</td>\n      <td>120.0</td>\n      <td>132.0</td>\n      <td>65.0</td>\n      <td>129.0</td>\n      <td>126.0</td>\n      <td>POINT (634196.250 226190.250)</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>72.0</td>\n      <td>60.0</td>\n      <td>47.0</td>\n      <td>69.0</td>\n      <td>82.0</td>\n      <td>46.0</td>\n      <td>POINT (639810.750 219749.250)</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>132.0</td>\n      <td>122.0</td>\n      <td>140.0</td>\n      <td>73.0</td>\n      <td>171.0</td>\n      <td>176.0</td>\n      <td>POINT (640352.250 218238.750)</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>170.0</td>\n      <td>157.0</td>\n      <td>176.0</td>\n      <td>80.0</td>\n      <td>182.0</td>\n      <td>183.0</td>\n      <td>POINT (639924.750 219692.250)</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>115.0</td>\n      <td>98.0</td>\n      <td>106.0</td>\n      <td>60.0</td>\n      <td>110.0</td>\n      <td>102.0</td>\n      <td>POINT (639953.250 219578.250)</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "sampling_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}